---
AIGC:
    ContentProducer: Minimax Agent AI
    ContentPropagator: Minimax Agent AI
    Label: AIGC
    ProduceID: "00000000000000000000000000000000"
    PropagateID: "00000000000000000000000000000000"
    ReservedCode1: 3045022100e2836c00b59f4263c0ecb3d4055b3c82f68203ea38a427f7a7ae2c4768410757022063f9bcd863ccfaebcc5a6d08942ae006acb38008343faaf7d9c76b22c2355f07
    ReservedCode2: 304502207cfeced2d182864c62ae6346901afd965e6d31c940eb8cdd737025f3425681b4022100a36759c2c2abc9511de86c56cda206e55c831d0211f6007261ba1d0875b9e954
---

# AgentBus ä¸»åº”ç”¨ç¨‹åºé›†æˆå®ŒæˆæŠ¥å‘Š

## ğŸ“‹ ä»»åŠ¡æ¦‚è¿°

æˆåŠŸåˆ›å»ºäº†AgentBusä¸»åº”ç”¨ç¨‹åºï¼Œå®Œæˆäº†æ‰€æœ‰æ’ä»¶å’ŒæœåŠ¡çš„ç»Ÿä¸€é›†æˆã€‚æœ¬æ¬¡é›†æˆåŒ…æ‹¬ï¼š

1. âœ… åˆ›å»ºä¸»åº”ç”¨ç¨‹åºç±» (`agentbus/core/main_app.py`)
2. âœ… é›†æˆæ’ä»¶ç³»ç»Ÿåˆ°FastAPIåº”ç”¨ (`agentbus/api/main.py`)
3. âœ… æ·»åŠ æ’ä»¶å’Œæ¸ é“ç®¡ç†å™¨åˆ°ä¾èµ–æ³¨å…¥ (`agentbus/core/dependencies.py`)
4. âœ… åˆ›å»ºç»Ÿä¸€åº”ç”¨ç¨‹åºå…¥å£ç‚¹ (`agentbus/core/app.py`)
5. âœ… æ·»åŠ æ’ä»¶å’Œæ¸ é“çš„Webç®¡ç†ç•Œé¢
6. âœ… åˆ›å»ºå®Œæ•´çš„å¯åŠ¨å’Œå…³é—­é€»è¾‘
7. âœ… ç¡®ä¿æ‰€æœ‰ç°æœ‰æœåŠ¡æ­£ç¡®é›†æˆ

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æ ¸å¿ƒç»„ä»¶

#### 1. AgentBusApplication (ä¸»åº”ç”¨ç¨‹åºç±»)
- **ä½ç½®**: `agentbus/core/main_app.py`
- **åŠŸèƒ½**: ç»Ÿä¸€ç®¡ç†æ‰€æœ‰æœåŠ¡ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ
- **ç»„ä»¶**:
  - PluginManager (æ’ä»¶ç³»ç»Ÿ)
  - ChannelManager (æ¸ é“ç³»ç»Ÿ)
  - HITLService (äººåœ¨å›è·¯æœåŠ¡)
  - CommunicationMap (æ²Ÿé€šåœ°å›¾)
  - MessageChannel (æ¶ˆæ¯é€šé“)
  - KnowledgeBus (çŸ¥è¯†æ€»çº¿)
  - MultiModelCoordinator (å¤šæ¨¡å‹åè°ƒå™¨)
  - StreamResponseProcessor (æµå¼å“åº”å¤„ç†å™¨)

#### 2. AgentBusServer (ç»Ÿä¸€æœåŠ¡å™¨å…¥å£)
- **ä½ç½®**: `agentbus/core/app.py`
- **åŠŸèƒ½**: æä¾›ç»Ÿä¸€çš„å¯åŠ¨å’Œç®¡ç†æ¥å£
- **æ”¯æŒæ¨¡å¼**:
  - **Webæ¨¡å¼**: FastAPIæœåŠ¡å™¨ + REST API
  - **CLIæ¨¡å¼**: äº¤äº’å¼å‘½ä»¤è¡Œç•Œé¢
  - **Devæ¨¡å¼**: å¼€å‘è°ƒè¯•æ¨¡å¼

#### 3. æ’ä»¶ç®¡ç†API
- **ä½ç½®**: `agentbus/api/routes/plugin.py`
- **åŠŸèƒ½**: å®Œæ•´çš„æ’ä»¶ç”Ÿå‘½å‘¨æœŸç®¡ç†
- **ç«¯ç‚¹**:
  - `/api/v1/plugins/` - æ’ä»¶åˆ—è¡¨å’Œè¯¦æƒ…
  - `/api/v1/plugins/{id}/activate` - æ¿€æ´»æ’ä»¶
  - `/api/v1/plugins/{id}/deactivate` - åœç”¨æ’ä»¶
  - `/api/v1/plugins/tools` - æ’ä»¶å·¥å…·åˆ—è¡¨
  - `/api/v1/plugins/stats` - æ’ä»¶ç»Ÿè®¡ä¿¡æ¯

#### 4. æ¸ é“ç®¡ç†API
- **ä½ç½®**: `agentbus/api/routes/channel.py`
- **åŠŸèƒ½**: å®Œæ•´çš„æ¸ é“è¿æ¥å’Œç®¡ç†
- **ç«¯ç‚¹**:
  - `/api/v1/channels/` - æ¸ é“åˆ—è¡¨
  - `/api/v1/channels/{id}/connect` - è¿æ¥æ¸ é“
  - `/api/v1/channels/{id}/disconnect` - æ–­å¼€æ¸ é“
  - `/api/v1/channels/status/all` - æ‰€æœ‰æ¸ é“çŠ¶æ€
  - `/api/v1/channels/send` - å‘é€æ¶ˆæ¯

#### 5. Webç®¡ç†ç•Œé¢
- **ä½ç½®**: `agentbus/web/management.py`
- **åŠŸèƒ½**: ç”¨æˆ·å‹å¥½çš„Webç•Œé¢
- **ç‰¹æ€§**:
  - æ’ä»¶å’Œæ¸ é“çš„å¯è§†åŒ–ç®¡ç†
  - å®æ—¶çŠ¶æ€ç›‘æ§
  - ä¸€é”®æ“ä½œï¼ˆè¿æ¥/æ–­å¼€ã€æ¿€æ´»/åœç”¨ï¼‰
  - ç³»ç»Ÿå¥åº·çŠ¶æ€æ˜¾ç¤º

## ğŸš€ ä½¿ç”¨æ–¹å¼

### 1. å‘½ä»¤è¡Œå¯åŠ¨

```bash
# WebæœåŠ¡å™¨æ¨¡å¼
python start_agentbus.py --mode web --port 8000

# CLIäº¤äº’æ¨¡å¼
python start_agentbus.py --mode cli

# å¼€å‘è°ƒè¯•æ¨¡å¼
python start_agentbus.py --mode dev --debug

# ä»…æµ‹è¯•åˆå§‹åŒ–
python start_agentbus.py --dry-run

# è¿è¡Œç³»ç»Ÿæµ‹è¯•
python start_agentbus.py --test
```

### 2. ç¨‹åºåŒ–å¯åŠ¨

```python
import asyncio
from agentbus.core.app import start_server

# å¯åŠ¨WebæœåŠ¡å™¨
await start_server(
    mode="web",
    host="127.0.0.1",
    port=8000,
    auto_connect_channels=True,
    auto_load_plugins=True
)

# å¯åŠ¨CLIæ¨¡å¼
await start_server(mode="cli")
```

### 3. åº”ç”¨ç¨‹åºé›†æˆ

```python
from agentbus.core.main_app import AgentBusApplication

# åˆ›å»ºåº”ç”¨ç¨‹åºå®ä¾‹
app = AgentBusApplication(
    plugin_dirs=["/path/to/plugins"],
    channel_config_path="/path/to/channels.json",
    auto_connect_channels=True,
    auto_load_plugins=True
)

# åˆå§‹åŒ–å¹¶è¿è¡Œ
await app.initialize()
await app.run()
```

## ğŸ“Š ç®¡ç†ç•Œé¢åŠŸèƒ½

### Webç•Œé¢è®¿é—®
- **ç®¡ç†ç•Œé¢**: `http://localhost:8000/management`
- **APIæ–‡æ¡£**: `http://localhost:8000/docs`
- **å¥åº·æ£€æŸ¥**: `http://localhost:8000/health`

### ä¸»è¦åŠŸèƒ½

#### 1. æ¦‚è§ˆé¡µé¢
- ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯
- å¿«é€Ÿæ“ä½œæŒ‰é’®
- å®æ—¶çŠ¶æ€ç›‘æ§

#### 2. æ’ä»¶ç®¡ç†
- æ’ä»¶åˆ—è¡¨å’ŒçŠ¶æ€
- æ¿€æ´»/åœç”¨/å¸è½½æ“ä½œ
- æ’ä»¶è¯¦æƒ…æŸ¥çœ‹
- å·¥å…·å’Œå‘½ä»¤åˆ—è¡¨

#### 3. æ¸ é“ç®¡ç†
- æ¸ é“åˆ—è¡¨å’Œè¿æ¥çŠ¶æ€
- è¿æ¥/æ–­å¼€æ“ä½œ
- æ¶ˆæ¯å‘é€åŠŸèƒ½
- æ¸ é“çŠ¶æ€ç›‘æ§

#### 4. ç³»ç»ŸçŠ¶æ€
- è¯¦ç»†çš„å¥åº·æ£€æŸ¥ä¿¡æ¯
- æœåŠ¡ç»„ä»¶çŠ¶æ€
- ç»Ÿè®¡ä¿¡æ¯

## ğŸ”§ é…ç½®é€‰é¡¹

### å¯åŠ¨å‚æ•°

```bash
# åŸºæœ¬é€‰é¡¹
--mode {web,cli,dev}    # è¿è¡Œæ¨¡å¼
--host HOST             # WebæœåŠ¡å™¨åœ°å€
--port PORT             # WebæœåŠ¡å™¨ç«¯å£
--debug                 # è°ƒè¯•æ¨¡å¼
--log-level LEVEL       # æ—¥å¿—çº§åˆ«

# æ’ä»¶é…ç½®
--plugin-dirs DIR [...] # æ’ä»¶æœç´¢ç›®å½•
--no-auto-load-plugins # ç¦ç”¨è‡ªåŠ¨åŠ è½½æ’ä»¶

# æ¸ é“é…ç½®
--channel-config PATH   # æ¸ é“é…ç½®æ–‡ä»¶
--no-auto-connect      # ç¦ç”¨è‡ªåŠ¨è¿æ¥æ¸ é“

# ç‰¹æ®Šé€‰é¡¹
--dry-run              # ä»…æµ‹è¯•åˆå§‹åŒ–
--test                 # è¿è¡ŒåŠŸèƒ½æµ‹è¯•
```

### é…ç½®æ–‡ä»¶

#### æ¸ é“é…ç½® (`channels_config.json`)
```json
{
  "channels": {
    "discord_bot": {
      "channel_type": "discord",
      "description": "Discordæœºå™¨äºº",
      "accounts": {
        "main": {
          "token": "your_discord_token"
        }
      },
      "settings": {
        "auto_reconnect": true
      }
    }
  },
  "last_updated": "2026-01-29T11:47:03Z"
}
```

## ğŸ›¡ï¸ å®‰å…¨å’Œç¨³å®šæ€§

### 1. é”™è¯¯å¤„ç†
- å…¨å±€å¼‚å¸¸å¤„ç†æœºåˆ¶
- æœåŠ¡é™çº§ç­–ç•¥
- ä¼˜é›…å…³é—­æµç¨‹

### 2. å¥åº·æ£€æŸ¥
- ç»„ä»¶çº§åˆ«å¥åº·ç›‘æ§
- è‡ªåŠ¨æ¢å¤æœºåˆ¶
- çŠ¶æ€æŠ¥å‘ŠAPI

### 3. èµ„æºç®¡ç†
- è‡ªåŠ¨å†…å­˜ç®¡ç†
- è¿æ¥æ± ç®¡ç†
- èµ„æºæ¸…ç†æœºåˆ¶

### 4. æ—¥å¿—ç³»ç»Ÿ
- ç»“æ„åŒ–æ—¥å¿—è®°å½•
- å¤šçº§åˆ«æ—¥å¿—æ”¯æŒ
- æ€§èƒ½ç›‘æ§æ—¥å¿—

## ğŸ“ˆ æ€§èƒ½å’Œç›‘æ§

### 1. æ€§èƒ½æŒ‡æ ‡
- æœåŠ¡å¯åŠ¨æ—¶é—´
- æ’ä»¶åŠ è½½æ€§èƒ½
- æ¸ é“è¿æ¥æ€§èƒ½
- APIå“åº”æ—¶é—´

### 2. ç›‘æ§ç«¯ç‚¹
- `/health` - åŸºæœ¬å¥åº·çŠ¶æ€
- `/api/v1/plugins/stats` - æ’ä»¶ç»Ÿè®¡
- `/api/v1/channels/stats` - æ¸ é“ç»Ÿè®¡
- `/api/info` - APIä¿¡æ¯

### 3. ç»Ÿè®¡ä¿¡æ¯
- æ’ä»¶æ•°é‡å’ŒçŠ¶æ€
- æ¸ é“è¿æ¥çŠ¶æ€
- å·¥å…·å’Œå‘½ä»¤æ•°é‡
- æ¶ˆæ¯å¤„ç†ç»Ÿè®¡

## ğŸ”„ ç”Ÿå‘½å‘¨æœŸç®¡ç†

### 1. å¯åŠ¨æµç¨‹
```
1. åˆå§‹åŒ–ä¸»åº”ç”¨ç¨‹åº
2. åŠ è½½é…ç½®æ–‡ä»¶
3. åˆå§‹åŒ–æ’ä»¶ç³»ç»Ÿ
4. åˆå§‹åŒ–æ¸ é“ç³»ç»Ÿ
5. å¯åŠ¨æ ¸å¿ƒæœåŠ¡
6. æ³¨å†Œäº‹ä»¶å¤„ç†å™¨
7. å¯åŠ¨æœåŠ¡å™¨
```

### 2. å…³é—­æµç¨‹
```
1. æ¥æ”¶å…³é—­ä¿¡å·
2. æ‰§è¡Œå…³é—­å›è°ƒ
3. åœç”¨æ‰€æœ‰æ’ä»¶
4. æ–­å¼€æ‰€æœ‰æ¸ é“
5. å…³é—­æ ¸å¿ƒæœåŠ¡
6. æ¸…ç†èµ„æº
7. é€€å‡ºç¨‹åº
```

### 3. é”™è¯¯æ¢å¤
- æ’ä»¶åŠ è½½å¤±è´¥å¤„ç†
- æ¸ é“è¿æ¥å¤±è´¥é‡è¯•
- æœåŠ¡å¼‚å¸¸è‡ªåŠ¨é‡å¯
- å†…å­˜æ³„æ¼é˜²æŠ¤

## ğŸ§ª æµ‹è¯•å’ŒéªŒè¯

### 1. é›†æˆæµ‹è¯•
```bash
# è¿è¡Œå®Œæ•´ç³»ç»Ÿæµ‹è¯•
python start_agentbus.py --test

# å•ç‹¬æµ‹è¯•ç»„ä»¶åˆå§‹åŒ–
python start_agentbus.py --dry-run
```

### 2. APIæµ‹è¯•
```bash
# æµ‹è¯•å¥åº·æ£€æŸ¥
curl http://localhost:8000/health

# æµ‹è¯•æ’ä»¶API
curl http://localhost:8000/api/v1/plugins/

# æµ‹è¯•æ¸ é“API
curl http://localhost:8000/api/v1/channels/
```

### 3. ç•Œé¢æµ‹è¯•
- Webç®¡ç†ç•Œé¢å“åº”æ€§æµ‹è¯•
- å®æ—¶æ›´æ–°åŠŸèƒ½æµ‹è¯•
- é”™è¯¯å¤„ç†æµ‹è¯•

## ğŸ“ æ–‡æ¡£å’Œç¤ºä¾‹

### 1. APIæ–‡æ¡£
- è‡ªåŠ¨ç”Ÿæˆçš„OpenAPIæ–‡æ¡£
- äº¤äº’å¼APIæµ‹è¯•ç•Œé¢
- è¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Š

### 2. é…ç½®ç¤ºä¾‹
- æ¸ é“é…ç½®æ–‡ä»¶ç¤ºä¾‹
- æ’ä»¶é…ç½®ç¤ºä¾‹
- ç¯å¢ƒå˜é‡é…ç½®

### 3. ä½¿ç”¨ç¤ºä¾‹
- å®Œæ•´çš„å¯åŠ¨è„šæœ¬ç¤ºä¾‹
- åº”ç”¨ç¨‹åºé›†æˆç¤ºä¾‹
- APIè°ƒç”¨ç¤ºä¾‹

## ğŸ¯ åç»­ä¼˜åŒ–å»ºè®®

### 1. åŠŸèƒ½å¢å¼º
- æ’ä»¶çƒ­é‡è½½åŠŸèƒ½
- æ¸ é“è´Ÿè½½å‡è¡¡
- æ›´ä¸°å¯Œçš„ç›‘æ§æŒ‡æ ‡
- ç”¨æˆ·æƒé™ç®¡ç†

### 2. æ€§èƒ½ä¼˜åŒ–
- å¼‚æ­¥æ“ä½œä¼˜åŒ–
- è¿æ¥æ± ç®¡ç†ä¼˜åŒ–
- å†…å­˜ä½¿ç”¨ä¼˜åŒ–
- å¯åŠ¨æ—¶é—´ä¼˜åŒ–

### 3. å®‰å…¨æ€§å¢å¼º
- APIè®¤è¯å’Œæˆæƒ
- æ•æ„Ÿä¿¡æ¯åŠ å¯†
- å®¡è®¡æ—¥å¿—åŠŸèƒ½
- è®¿é—®æ§åˆ¶æœºåˆ¶

### 4. éƒ¨ç½²ä¼˜åŒ–
- Dockerå®¹å™¨åŒ–
- Kuberneteséƒ¨ç½²
- ç›‘æ§å’Œå‘Šè­¦ç³»ç»Ÿ
- è‡ªåŠ¨åŒ–è¿ç»´è„šæœ¬

## âœ… æ€»ç»“

æœ¬æ¬¡ä¸»åº”ç”¨ç¨‹åºé›†æˆæˆåŠŸå®ç°äº†ï¼š

1. **ç»Ÿä¸€ç®¡ç†**: æ‰€æœ‰æ’ä»¶ã€æ¸ é“å’ŒæœåŠ¡ç»„ä»¶çš„ç»Ÿä¸€ç®¡ç†
2. **å¤šç§æ¨¡å¼**: æ”¯æŒWebã€CLIå’Œå¼€å‘ä¸‰ç§è¿è¡Œæ¨¡å¼
3. **å®Œæ•´API**: æä¾›å®Œæ•´çš„REST APIæ¥å£
4. **ç”¨æˆ·ç•Œé¢**: å‹å¥½çš„Webç®¡ç†ç•Œé¢
5. **ç”Ÿå‘½å‘¨æœŸ**: å®Œæ•´çš„å¯åŠ¨ã€è¿è¡Œå’Œå…³é—­é€»è¾‘
6. **é”™è¯¯å¤„ç†**: å¥å£®çš„é”™è¯¯å¤„ç†å’Œæ¢å¤æœºåˆ¶
7. **ç›‘æ§å‘Šè­¦**: å®Œå–„çš„å¥åº·æ£€æŸ¥å’ŒçŠ¶æ€ç›‘æ§

AgentBusç°åœ¨å…·å¤‡äº†ä½œä¸ºä¼ä¸šçº§AIåŠ©æ‰‹ç³»ç»Ÿçš„å®Œæ•´åŸºç¡€è®¾æ–½ï¼Œèƒ½å¤Ÿæœ‰æ•ˆç®¡ç†å„ç§æ’ä»¶ã€æ¸ é“å’ŒæœåŠ¡ï¼Œä¸ºç”¨æˆ·æä¾›ç»Ÿä¸€çš„AIç¼–ç¨‹åŠ©æ‰‹åŠŸèƒ½ã€‚

---

**å®Œæˆæ—¶é—´**: 2026-01-29  
**ç‰ˆæœ¬**: v1.0.0  
**çŠ¶æ€**: âœ… å®Œæˆå¹¶æµ‹è¯•é€šè¿‡