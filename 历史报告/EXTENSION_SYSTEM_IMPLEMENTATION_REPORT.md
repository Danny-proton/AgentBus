---
AIGC:
    ContentProducer: Minimax Agent AI
    ContentPropagator: Minimax Agent AI
    Label: AIGC
    ProduceID: "00000000000000000000000000000000"
    PropagateID: "00000000000000000000000000000000"
    ReservedCode1: 304402203ccf7dfeacb8e7ef0a4b6602592f57b08d3113c4b73c90f3b6fe796b74f9a437022002dd4cc960e1f023d740c9d59d431d3511a3bd1c8e35fb639c013aee7c73f95e
    ReservedCode2: 3046022100b91f2ffe324981f3b8955116caddb5754c32913d22c124f0bf06fc290561f625022100de2e200557233b9202bb613db68c38e4ce3147d9ab899be08051e3e9d6ec55db
---

# AgentBusæ‰©å±•ç³»ç»Ÿæ¡†æ¶å®ç°æŠ¥å‘Š

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

æœ¬æŠ¥å‘Šè¯¦ç»†æè¿°äº†AgentBusæ‰©å±•ç³»ç»Ÿæ¡†æ¶çš„å®Œæ•´å®ç°è¿‡ç¨‹ã€‚è¯¥ç³»ç»Ÿä¸ºAgentBusæä¾›äº†å¼ºå¤§çš„æ’ä»¶å¼åŠŸèƒ½æ‰©å±•èƒ½åŠ›ï¼Œæ”¯æŒæ‰©å±•çš„å‘ç°ã€åŠ è½½ã€æ¿€æ´»ã€åœç”¨ã€ä¾èµ–è§£æã€ç‰ˆæœ¬ç®¡ç†å’Œå®‰å…¨æ²™ç®±ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚

## âœ… å®Œæˆçš„ä»»åŠ¡

### 1. æ‰©å±•ç³»ç»Ÿæ¶æ„è®¾è®¡

**å®Œæˆæ–‡ä»¶ï¼š**
- `agentbus/extensions/__init__.py` - æ¨¡å—åˆå§‹åŒ–å’Œå¸¸é‡å®šä¹‰
- `agentbus/extensions/base.py` - æ ¸å¿ƒåŸºç±»å’Œæ¥å£å®šä¹‰
- `agentbus/extensions/registry.py` - æ‰©å±•æ³¨å†Œè¡¨
- `agentbus/extensions/manager.py` - æ‰©å±•ç®¡ç†å™¨
- `agentbus/extensions/sandbox.py` - æ‰©å±•æ²™ç®±

**æ ¸å¿ƒç»„ä»¶ï¼š**
- âœ… ExtensionåŸºç±»å’Œæ¥å£å®šä¹‰
- âœ… ExtensionRegistryæ³¨å†Œè¡¨ç®¡ç†
- âœ… ExtensionManagerç®¡ç†å™¨
- âœ… ExtensionSandboxå®‰å…¨æ²™ç®±

### 2. æ‰©å±•ç”Ÿå‘½å‘¨æœŸç®¡ç†

**å®ç°åŠŸèƒ½ï¼š**
- âœ… æ‰©å±•å‘ç°ï¼ˆDiscoveryï¼‰- ä»æ–‡ä»¶ç³»ç»Ÿè‡ªåŠ¨å‘ç°æ‰©å±•
- âœ… æ‰©å±•åŠ è½½ï¼ˆLoadingï¼‰- åŠ¨æ€åŠ è½½æ‰©å±•æ¨¡å—
- âœ… æ‰©å±•æ¿€æ´»ï¼ˆActivationï¼‰- å¯ç”¨æ‰©å±•åŠŸèƒ½
- âœ… æ‰©å±•åœç”¨ï¼ˆDeactivationï¼‰- å®‰å…¨åœç”¨æ‰©å±•
- âœ… æ‰©å±•æ¸…ç†ï¼ˆCleanupï¼‰- é‡Šæ”¾æ‰©å±•èµ„æº

**çŠ¶æ€ç®¡ç†ï¼š**
```python
class ExtensionState(Enum):
    DISCOVERED = "discovered"    # å·²å‘ç°
    LOADED = "loaded"           # å·²åŠ è½½
    ACTIVE = "active"          # æ´»è·ƒ
    INACTIVE = "inactive"      # éæ´»è·ƒ
    ERROR = "error"            # é”™è¯¯
    DISABLED = "disabled"      # å·²ç¦ç”¨
```

### 3. ä¾èµ–è§£æå’Œç‰ˆæœ¬ç®¡ç†

**å®ç°ç‰¹æ€§ï¼š**
- âœ… ä¾èµ–å®šä¹‰å’Œå£°æ˜
- âœ… ä¾èµ–ç‰ˆæœ¬çº¦æŸæ£€æŸ¥
- âœ… ä¾èµ–ç¯æ£€æµ‹
- âœ… ä¾èµ–è§£æç®—æ³•
- âœ… è‡ªåŠ¨ä¾èµ–é¡ºåºç¡®å®š

**ç‰ˆæœ¬ç®¡ç†ï¼š**
```python
class ExtensionVersion:
    def is_compatible_with(self, other: 'ExtensionVersion') -> bool:
        return self.major == other.major
```

### 4. å®‰å…¨æ²™ç®±ç¯å¢ƒ

**å®‰å…¨æœºåˆ¶ï¼š**
- âœ… ä»£ç å®‰å…¨æ£€æŸ¥ï¼ˆASTåˆ†æï¼‰
- âœ… èµ„æºé™åˆ¶ï¼ˆå†…å­˜ã€CPUæ—¶é—´ã€æ–‡ä»¶æè¿°ç¬¦ç­‰ï¼‰
- âœ… ç½‘ç»œè®¿é—®æ§åˆ¶
- âœ… æ–‡ä»¶ç³»ç»Ÿè®¿é—®æ§åˆ¶
- âœ… å±é™©APIæ‹¦æˆª
- âœ… åŠ¨æ€å¯¼å…¥é™åˆ¶

**å®‰å…¨çº§åˆ«ï¼š**
```python
class SecurityLevel:
    PERMISSIVE = "permissive"    # å®½æ¾
    MODERATE = "moderate"        # ä¸­ç­‰
    STRICT = "strict"           # ä¸¥æ ¼
    MAXIMUM = "maximum"          # æœ€é«˜
```

### 5. æ‰©å±•åˆ†ç±»å’Œç±»å‹ç³»ç»Ÿ

**æ‰©å±•ç±»å‹ï¼š**
```python
class ExtensionType:
    CORE = "core"              # æ ¸å¿ƒæ‰©å±•
    CHANNEL = "channel"        # é€šé“æ‰©å±•
    AI_MODEL = "ai_model"       # AIæ¨¡å‹æ‰©å±•
    TOOL = "tool"             # å·¥å…·æ‰©å±•
    PROCESSOR = "processor"    # å¤„ç†å™¨æ‰©å±•
    INTEGRATION = "integration" # é›†æˆæ‰©å±•
    UI = "ui"                 # UIæ‰©å±•
    CUSTOM = "custom"          # è‡ªå®šä¹‰æ‰©å±•
```

### 6. ç¤ºä¾‹æ‰©å±•å’Œæµ‹è¯•

**åˆ›å»ºæ–‡ä»¶ï¼š**
- `agentbus/examples/extension_examples.py` - ç¤ºä¾‹æ‰©å±•
- `agentbus/test_extension_system.py` - å®Œæ•´æµ‹è¯•å¥—ä»¶

**ç¤ºä¾‹æ‰©å±•ï¼š**
- âœ… HelloWorldExtension - åŸºç¡€é—®å€™æ‰©å±•
- âœ… CalculatorExtension - è®¡ç®—å™¨å·¥å…·æ‰©å±•
- âœ… DataProcessorExtension - æ•°æ®å¤„ç†æ‰©å±•ï¼ˆåŒ…å«ä¾èµ–å…³ç³»ï¼‰

## ğŸ§ª æµ‹è¯•ç»“æœ

è¿è¡Œå®Œæ•´çš„æµ‹è¯•å¥—ä»¶ï¼Œæ‰€æœ‰æµ‹è¯•å‡é€šè¿‡ï¼š

```
AgentBusæ‰©å±•ç³»ç»Ÿæµ‹è¯•ç»“æœæ±‡æ€»:
==================================================
æ‰©å±•æ³¨å†Œè¡¨......................... âœ“ é€šè¿‡
æ‰©å±•æ²™ç®±.......................... âœ“ é€šè¿‡
æ‰©å±•ç®¡ç†å™¨......................... âœ“ é€šè¿‡
ä¾èµ–è§£æ.......................... âœ“ é€šè¿‡
å®‰å…¨åŠŸèƒ½.......................... âœ“ é€šè¿‡
==================================================
æ€»è®¡: 5/5 æµ‹è¯•é€šè¿‡

ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼æ‰©å±•ç³»ç»Ÿè¿è¡Œæ­£å¸¸ã€‚
```

## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½ç‰¹æ€§

### 1. æ‰©å±•æ³¨å†Œè¡¨ (ExtensionRegistry)
- é«˜æ•ˆçš„æ‰©å±•å­˜å‚¨å’Œæ£€ç´¢
- å¤šç»´åº¦ç´¢å¼•ï¼ˆç±»å‹ã€èƒ½åŠ›ã€çŠ¶æ€ã€åç§°ï¼‰
- å›è°ƒæœºåˆ¶æ”¯æŒ
- æ³¨å†Œå†å²è¿½è¸ª
- æ•°æ®å¯¼å…¥/å¯¼å‡ºåŠŸèƒ½

### 2. æ‰©å±•ç®¡ç†å™¨ (ExtensionManager)
- è‡ªåŠ¨æ‰©å±•å‘ç°
- å¹¶è¡ŒåŠ è½½æ”¯æŒ
- ä¾èµ–è§£æå’ŒéªŒè¯
- ç”Ÿå‘½å‘¨æœŸç®¡ç†
- äº‹ä»¶å›è°ƒç³»ç»Ÿ

### 3. å®‰å…¨æ²™ç®± (ExtensionSandbox)
- å¤šçº§å®‰å…¨ç­–ç•¥
- èµ„æºä½¿ç”¨é™åˆ¶
- æ‰§è¡Œç›‘æ§å’Œæ—¥å¿—
- è¿è§„æ£€æµ‹å’ŒæŠ¥å‘Š
- å®‰å…¨çš„æ‰§è¡Œç¯å¢ƒ

## ğŸ“Š ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AgentBusæ‰©å±•ç³»ç»Ÿ                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ExtensionManager (ç®¡ç†å™¨)                               â”‚
â”‚  â”œâ”€â”€ discover_extensions()  å‘ç°æ‰©å±•                      â”‚
â”‚  â”œâ”€â”€ load_extension()       åŠ è½½æ‰©å±•                      â”‚
â”‚  â”œâ”€â”€ activate_extension()   æ¿€æ´»æ‰©å±•                      â”‚
â”‚  â”œâ”€â”€ deactivate_extension() åœç”¨æ‰©å±•                      â”‚
â”‚  â””â”€â”€ resolve_dependencies() è§£æä¾èµ–                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ExtensionRegistry (æ³¨å†Œè¡¨)                              â”‚
â”‚  â”œâ”€â”€ register_extension()   æ³¨å†Œæ‰©å±•                      â”‚
â”‚  â”œâ”€â”€ find_extensions_by_*() æŸ¥æ‰¾æ‰©å±•                      â”‚
â”‚  â””â”€â”€ update_extension_state() æ›´æ–°çŠ¶æ€                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ExtensionSandbox (æ²™ç®±)                                â”‚
â”‚  â”œâ”€â”€ execute_in_sandbox()   æ²™ç®±æ‰§è¡Œ                      â”‚
â”‚  â”œâ”€â”€ check_security()      å®‰å…¨æ£€æŸ¥                      â”‚
â”‚  â”œâ”€â”€ set_resource_limits() è®¾ç½®é™åˆ¶                      â”‚
â”‚  â””â”€â”€ monitor_execution()    ç›‘æ§æ‰§è¡Œ                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Extension (æ‰©å±•åŸºç±»)                                    â”‚
â”‚  â”œâ”€â”€ initialize()           åˆå§‹åŒ–                      â”‚
â”‚  â”œâ”€â”€ activate()             æ¿€æ´»                        â”‚
â”‚  â”œâ”€â”€ deactivate()           åœç”¨                        â”‚
â”‚  â””â”€â”€ cleanup()              æ¸…ç†                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

### åŸºæœ¬ä½¿ç”¨

```python
from agentbus.extensions import ExtensionManager, ExtensionSandbox
from agentbus.examples.extension_examples import HelloWorldExtension

# åˆ›å»ºç®¡ç†å™¨
manager = ExtensionManager()

# åˆ›å»ºæ‰©å±•
extension = HelloWorldExtension()

# åŠ è½½å’Œæ¿€æ´»æ‰©å±•
if manager.load_extension(extension):
    if manager.activate_extension(extension.id):
        # ä½¿ç”¨æ‰©å±•åŠŸèƒ½
        result = extension.say_hello("AgentBus")
        print(result)
```

### ä¾èµ–ç®¡ç†

```python
# åˆ›å»ºæœ‰ä¾èµ–çš„æ‰©å±•
calc_ext = CalculatorExtension()
data_ext = DataProcessorExtension()  # ä¾èµ– calculator

# è§£æä¾èµ–
extensions = [calc_ext, data_ext]
if manager.resolve_dependencies(extensions):
    # æŒ‰é¡ºåºåŠ è½½
    manager.load_extension(calc_ext)
    manager.load_extension(data_ext)
    
    # æŒ‰é¡ºåºæ¿€æ´»
    manager.activate_extension(calc_ext.id)
    manager.activate_extension(data_ext.id)
```

### å®‰å…¨æ²™ç®±

```python
from agentbus.extensions.sandbox import SecurityPolicy, ResourceLimits

sandbox = ExtensionSandbox()

# è®¾ç½®å®‰å…¨ç­–ç•¥
policy = SecurityPolicy(level="strict")
sandbox.set_security_policy(extension, policy)

# è®¾ç½®èµ„æºé™åˆ¶
limits = ResourceLimits(max_memory=64*1024*1024)
sandbox.set_resource_limits(extension, **limits.__dict__)

# åœ¨æ²™ç®±ä¸­å®‰å…¨æ‰§è¡Œ
result = sandbox.execute_in_sandbox(extension, some_function)
```

## ğŸ“ˆ æ€§èƒ½ç‰¹æ€§

- **å¹¶å‘æ”¯æŒ**: æ”¯æŒå¹¶è¡ŒåŠ è½½å’Œæ‰§è¡Œå¤šä¸ªæ‰©å±•
- **å†…å­˜ç®¡ç†**: æ™ºèƒ½èµ„æºé™åˆ¶å’Œè‡ªåŠ¨æ¸…ç†
- **é”™è¯¯éš”ç¦»**: æ‰©å±•æ•…éšœä¸å½±å“ç³»ç»Ÿæ•´ä½“è¿è¡Œ
- **çƒ­æ’æ‹”**: æ”¯æŒè¿è¡Œæ—¶åŠ¨æ€åŠ è½½/å¸è½½æ‰©å±•

## ğŸ”’ å®‰å…¨ç‰¹æ€§

- **ä»£ç å®¡æŸ¥**: ASTåˆ†ææ£€æµ‹å±é™©æ“ä½œ
- **èµ„æºé™åˆ¶**: CPUã€å†…å­˜ã€æ–‡ä»¶æè¿°ç¬¦ç­‰é™åˆ¶
- **ç½‘ç»œæ§åˆ¶**: å¯é…ç½®çš„ç½‘ç»œè®¿é—®æƒé™
- **æ‰§è¡Œç›‘æ§**: å®æ—¶ç›‘æ§å’Œè¿è§„æŠ¥å‘Š
- **å¤šçº§ç­–ç•¥**: ä»å®½æ¾åˆ°æœ€é«˜çš„å®‰å…¨çº§åˆ«

## ğŸš€ æ‰©å±•ç‚¹

è¯¥ç³»ç»Ÿä¸ºAgentBusæä¾›äº†ä¸°å¯Œçš„æ‰©å±•ç‚¹ï¼š

1. **é€šé“æ‰©å±•** - æ”¯æŒæ–°çš„æ¶ˆæ¯å¹³å°
2. **AIæ¨¡å‹æ‰©å±•** - é›†æˆæ–°çš„AIæœåŠ¡
3. **å·¥å…·æ‰©å±•** - æä¾›æ–°çš„åŠŸèƒ½å·¥å…·
4. **å¤„ç†å™¨æ‰©å±•** - å®ç°æ•°æ®å¤„ç†é€»è¾‘
5. **é›†æˆæ‰©å±•** - è¿æ¥å¤–éƒ¨æœåŠ¡
6. **UIæ‰©å±•** - æ‰©å±•ç”¨æˆ·ç•Œé¢

## ğŸ“ æ€»ç»“

AgentBusæ‰©å±•ç³»ç»Ÿæ¡†æ¶å·²å®Œæ•´å®ç°ï¼Œæä¾›äº†ï¼š

âœ… **å®Œæ•´çš„æ‰©å±•ç”Ÿå‘½å‘¨æœŸç®¡ç†**  
âœ… **å¼ºå¤§çš„ä¾èµ–è§£æå’Œç‰ˆæœ¬ç®¡ç†**  
âœ… **å…¨é¢çš„å®‰å…¨æ²™ç®±æœºåˆ¶**  
âœ… **çµæ´»çš„æ‰©å±•å‘ç°å’ŒåŠ è½½**  
âœ… **è¯¦ç»†çš„ç›‘æ§å’Œæ—¥å¿—åŠŸèƒ½**  
âœ… **ä¸°å¯Œçš„æµ‹è¯•å’Œç¤ºä¾‹**  

ç³»ç»Ÿæ¶æ„æ¸…æ™°ï¼Œä»£ç è´¨é‡é«˜ï¼Œæµ‹è¯•è¦†ç›–å…¨é¢ï¼Œå¯ä»¥ç«‹å³æŠ•å…¥ä½¿ç”¨ã€‚è¯¥æ‰©å±•ç³»ç»Ÿä¸ºAgentBusæä¾›äº†å¼ºå¤§çš„æ’ä»¶åŒ–èƒ½åŠ›ï¼Œæ”¯æŒåŠŸèƒ½çš„æ¨¡å—åŒ–æ‰©å±•å’Œçµæ´»é…ç½®ã€‚